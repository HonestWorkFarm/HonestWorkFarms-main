{"ast":null,"code":"import{jsx as _jsx}from\"react/jsx-runtime\";import _objectSpread from\"/home/mike/Documents/Work/repos/HonestWorkFarms-main/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _taggedTemplateLiteral from\"/home/mike/Documents/Work/repos/HonestWorkFarms-main/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _slicedToArray from\"/home/mike/Documents/Work/repos/HonestWorkFarms-main/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  align-items: center;\\n  background-image: url('/images/egg/3ba.svg');\\n  background-repeat: no-repeat;\\n  background-position: top center;\\n  display: flex;\\n  justify-content: center;\\n  flex-direction: column;\\n  margin: auto;\\n  margin-bottom: 32px;\\n  padding-top: 116px;\\n  text-align: center;\\n\\n  \",\" {\\n    background-image: url('/images/egg/9.png');\\n    background-position: left center, right center;\\n    height: 165px;\\n    padding-top: 0;\\n  }\\n  \"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useEffect,useCallback,useState}from'react';import styled from'styled-components';import{useRouteMatch}from'react-router-dom';import{useDispatch}from'react-redux';import BigNumber from'bignumber.js';import{useWallet}from'@binance-chain/bsc-use-wallet';import{Heading}from'@pancakeswap-libs/uikit';import{BLOCKS_PER_YEAR}from'config';import Page from'components/layout/Page';import{useFarms,usePriceBnbBusd,usePriceCakeBusd}from'state/hooks';import useRefresh from'hooks/useRefresh';import{fetchFarmUserDataAsync}from'state/actions';import{QuoteToken}from'config/constants/types';import useI18n from'hooks/useI18n';import FarmCard from'./components/FarmCard/FarmCard';var Farms=function Farms(farmsProps){var _useRouteMatch=useRouteMatch(),path=_useRouteMatch.path;var TranslateString=useI18n();var farmsLP=useFarms();var cakePrice=usePriceCakeBusd();var bnbPrice=usePriceBnbBusd();var _useWallet=useWallet(),account=_useWallet.account,ethereum=_useWallet.ethereum;var tokenMode=farmsProps.tokenMode;var dispatch=useDispatch();var _useRefresh=useRefresh(),fastRefresh=_useRefresh.fastRefresh;useEffect(function(){if(account){dispatch(fetchFarmUserDataAsync(account));}},[account,dispatch,fastRefresh]);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),stakedOnly=_useState2[0],setStakedOnly=_useState2[1];var activeFarms=farmsLP.filter(function(farm){return!!farm.isTokenOnly===!!tokenMode&&farm.multiplier!=='0X'&&farm.pid!==8;});var inactiveFarms=farmsLP.filter(function(farm){return!!farm.isTokenOnly===!!tokenMode&&farm.multiplier==='0X'&&farm.pid!==8;});var stakedOnlyFarms=activeFarms.filter(function(farm){return farm.userData&&new BigNumber(farm.userData.stakedBalance).isGreaterThan(0);});var Hero=styled.div(_templateObject(),function(_ref){var theme=_ref.theme;return theme.mediaQueries.lg;});// /!\\ This function will be removed soon\n// This function compute the APY for each farm and will be replaced when we have a reliable API\n// to retrieve assets prices against USD\nvar farmsList=useCallback(function(farmsToDisplay,removed){// const cakePriceVsBNB = new BigNumber(farmsLP.find((farm) => farm.pid === CAKE_POOL_PID)?.tokenPriceVsQuote || 0)\n// let userTotalTVL = new BigNumber(0);\n// let userAllowance = 0;\nvar farmsToDisplayWithAPY=farmsToDisplay.map(function(farm){// if (!farm.tokenAmount || !farm.lpTotalInQuoteToken || !farm.lpTotalInQuoteToken) {\n//   return farm\n// }\nvar cakeRewardPerBlock=new BigNumber(farm.honestPerBlock||1).times(new BigNumber(farm.poolWeight)).div(new BigNumber(10).pow(18));var cakeRewardPerYear=cakeRewardPerBlock.times(BLOCKS_PER_YEAR);// if (farm.userData) {\n//   const userShare = new BigNumber(farm.userData.stakedBalance).div(1000000000000000000).multipliedBy(farm.tokenPriceVsQuote)\n//   userTotalTVL = userTotalTVL.plus(userShare)\n//   const userWL = Whitelist.find(add => add.wallet === account);\n//   userAllowance = userWL.allowance\n// }\nvar apy=cakePrice.times(cakeRewardPerYear);var totalValue=new BigNumber(farm.lpTotalInQuoteToken||0);if(farm.quoteTokenSymbol===QuoteToken.BNB){totalValue=totalValue.times(bnbPrice);}if(totalValue.comparedTo(0)>0){apy=apy.div(totalValue);}return _objectSpread(_objectSpread({},farm),{},{apy:apy});});return farmsToDisplayWithAPY.map(function(farm){return/*#__PURE__*/_jsx(FarmCard,{farm:farm,removed:removed,bnbPrice:bnbPrice,cakePrice:cakePrice,ethereum:ethereum,account:account},farm.pid);});},[bnbPrice,account,cakePrice,ethereum]);return/*#__PURE__*/_jsx(Page,{children:/*#__PURE__*/_jsx(Hero,{children:/*#__PURE__*/_jsx(Heading,{as:\"h1\",size:\"xl\",mb:\"24px\",color:\"secondary\",children:\"\\uD83D\\uDE9C Cabbage Carrot and other veggie NFTs Coming Soon... \\uD83D\\uDE9C\"})})});};export default Farms;","map":{"version":3,"sources":["/home/mike/Documents/Work/repos/HonestWorkFarms-main/src/views/Teaser/Teaser.tsx"],"names":["React","useEffect","useCallback","useState","styled","useRouteMatch","useDispatch","BigNumber","useWallet","Heading","BLOCKS_PER_YEAR","Page","useFarms","usePriceBnbBusd","usePriceCakeBusd","useRefresh","fetchFarmUserDataAsync","QuoteToken","useI18n","FarmCard","Farms","farmsProps","path","TranslateString","farmsLP","cakePrice","bnbPrice","account","ethereum","tokenMode","dispatch","fastRefresh","stakedOnly","setStakedOnly","activeFarms","filter","farm","isTokenOnly","multiplier","pid","inactiveFarms","stakedOnlyFarms","userData","stakedBalance","isGreaterThan","Hero","div","theme","mediaQueries","lg","farmsList","farmsToDisplay","removed","farmsToDisplayWithAPY","map","cakeRewardPerBlock","honestPerBlock","times","poolWeight","pow","cakeRewardPerYear","apy","totalValue","lpTotalInQuoteToken","quoteTokenSymbol","BNB","comparedTo"],"mappings":"mpCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,WAA3B,CAAwCC,QAAxC,KAAwD,OAAxD,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,OAAgBC,aAAhB,KAAqC,kBAArC,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,MAAOC,CAAAA,SAAP,KAAsB,cAAtB,CACA,OAASC,SAAT,KAA0B,+BAA1B,CAEA,OAAgBC,OAAhB,KAA+B,yBAA/B,CACA,OAASC,eAAT,KAA+D,QAA/D,CAEA,MAAOC,CAAAA,IAAP,KAAiB,wBAAjB,CACA,OAASC,QAAT,CAAmBC,eAAnB,CAAoCC,gBAApC,KAA4D,aAA5D,CACA,MAAOC,CAAAA,UAAP,KAAuB,kBAAvB,CACA,OAASC,sBAAT,KAAuC,eAAvC,CACA,OAASC,UAAT,KAA2B,wBAA3B,CACA,MAAOC,CAAAA,OAAP,KAAoB,eAApB,CACA,MAAOC,CAAAA,QAAP,KAA8C,gCAA9C,CAQA,GAAMC,CAAAA,KAA2B,CAAG,QAA9BA,CAAAA,KAA8B,CAACC,UAAD,CAAgB,oBACjChB,aAAa,EADoB,CAC1CiB,IAD0C,gBAC1CA,IAD0C,CAElD,GAAMC,CAAAA,eAAe,CAAGL,OAAO,EAA/B,CACA,GAAMM,CAAAA,OAAO,CAAGZ,QAAQ,EAAxB,CACA,GAAMa,CAAAA,SAAS,CAAGX,gBAAgB,EAAlC,CACA,GAAMY,CAAAA,QAAQ,CAAGb,eAAe,EAAhC,CALkD,eAMqBL,SAAS,EAN9B,CAM1CmB,OAN0C,YAM1CA,OAN0C,CAMjCC,QANiC,YAMjCA,QANiC,IAO3CC,CAAAA,SAP2C,CAO9BR,UAP8B,CAO3CQ,SAP2C,CASlD,GAAMC,CAAAA,QAAQ,CAAGxB,WAAW,EAA5B,CATkD,gBAU1BS,UAAU,EAVgB,CAU1CgB,WAV0C,aAU1CA,WAV0C,CAWlD9B,SAAS,CAAC,UAAM,CACd,GAAI0B,OAAJ,CAAa,CACXG,QAAQ,CAACd,sBAAsB,CAACW,OAAD,CAAvB,CAAR,CACD,CACF,CAJQ,CAIN,CAACA,OAAD,CAAUG,QAAV,CAAoBC,WAApB,CAJM,CAAT,CAXkD,cAiBd5B,QAAQ,CAAC,KAAD,CAjBM,wCAiB3C6B,UAjB2C,eAiB/BC,aAjB+B,eAmBlD,GAAMC,CAAAA,WAAW,CAAGV,OAAO,CAACW,MAAR,CAAe,SAACC,IAAD,QAAU,CAAC,CAACA,IAAI,CAACC,WAAP,GAAuB,CAAC,CAACR,SAAzB,EAAsCO,IAAI,CAACE,UAAL,GAAoB,IAA1D,EAAkEF,IAAI,CAACG,GAAL,GAAa,CAAzF,EAAf,CAApB,CACA,GAAMC,CAAAA,aAAa,CAAGhB,OAAO,CAACW,MAAR,CAAe,SAACC,IAAD,QAAU,CAAC,CAACA,IAAI,CAACC,WAAP,GAAuB,CAAC,CAACR,SAAzB,EAAsCO,IAAI,CAACE,UAAL,GAAoB,IAA1D,EAAkEF,IAAI,CAACG,GAAL,GAAa,CAAzF,EAAf,CAAtB,CAEA,GAAME,CAAAA,eAAe,CAAGP,WAAW,CAACC,MAAZ,CACtB,SAACC,IAAD,QAAUA,CAAAA,IAAI,CAACM,QAAL,EAAiB,GAAInC,CAAAA,SAAJ,CAAc6B,IAAI,CAACM,QAAL,CAAcC,aAA5B,EAA2CC,aAA3C,CAAyD,CAAzD,CAA3B,EADsB,CAAxB,CAIA,GAAMC,CAAAA,IAAI,CAAGzC,MAAM,CAAC0C,GAAV,mBAaR,kBAAGC,CAAAA,KAAH,MAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACC,YAAN,CAAmBC,EAAlC,EAbQ,CAAV,CAqBA;AACA;AACA;AACA,GAAMC,CAAAA,SAAS,CAAGhD,WAAW,CAC3B,SAACiD,cAAD,CAAiBC,OAAjB,CAAsC,CACpC;AACA;AACA;AACA,GAAMC,CAAAA,qBAA4C,CAAGF,cAAc,CAACG,GAAf,CAAmB,SAAClB,IAAD,CAAU,CAChF;AACA;AACA;AACA,GAAMmB,CAAAA,kBAAkB,CAAG,GAAIhD,CAAAA,SAAJ,CAAc6B,IAAI,CAACoB,cAAL,EAAuB,CAArC,EAAwCC,KAAxC,CAA8C,GAAIlD,CAAAA,SAAJ,CAAc6B,IAAI,CAACsB,UAAnB,CAA9C,EAA+EZ,GAA/E,CAAmF,GAAIvC,CAAAA,SAAJ,CAAc,EAAd,EAAkBoD,GAAlB,CAAsB,EAAtB,CAAnF,CAA3B,CACA,GAAMC,CAAAA,iBAAiB,CAAGL,kBAAkB,CAACE,KAAnB,CAAyB/C,eAAzB,CAA1B,CACA;AACA;AACA;AACA;AACA;AACA;AAEA,GAAImD,CAAAA,GAAG,CAAGpC,SAAS,CAACgC,KAAV,CAAgBG,iBAAhB,CAAV,CAEA,GAAIE,CAAAA,UAAU,CAAG,GAAIvD,CAAAA,SAAJ,CAAc6B,IAAI,CAAC2B,mBAAL,EAA4B,CAA1C,CAAjB,CAEA,GAAI3B,IAAI,CAAC4B,gBAAL,GAA0B/C,UAAU,CAACgD,GAAzC,CAA8C,CAC5CH,UAAU,CAAGA,UAAU,CAACL,KAAX,CAAiB/B,QAAjB,CAAb,CACD,CAED,GAAGoC,UAAU,CAACI,UAAX,CAAsB,CAAtB,EAA2B,CAA9B,CAAgC,CAC9BL,GAAG,CAAGA,GAAG,CAACf,GAAJ,CAAQgB,UAAR,CAAN,CACD,CAED,sCAAY1B,IAAZ,MAAkByB,GAAG,CAAHA,GAAlB,GACD,CA1BoD,CAArD,CA2BA,MAAOR,CAAAA,qBAAqB,CAACC,GAAtB,CAA0B,SAAClB,IAAD,qBAC/B,KAAC,QAAD,EAEE,IAAI,CAAEA,IAFR,CAGE,OAAO,CAAEgB,OAHX,CAIE,QAAQ,CAAE1B,QAJZ,CAKE,SAAS,CAAED,SALb,CAME,QAAQ,CAAEG,QANZ,CAOE,OAAO,CAAED,OAPX,EACOS,IAAI,CAACG,GADZ,CAD+B,EAA1B,CAAP,CAWD,CA3C0B,CA4C3B,CAACb,QAAD,CAAWC,OAAX,CAAoBF,SAApB,CAA+BG,QAA/B,CA5C2B,CAA7B,CA+CA,mBACE,KAAC,IAAD,wBACE,KAAC,IAAD,wBACE,KAAC,OAAD,EAAS,EAAE,CAAC,IAAZ,CAAiB,IAAI,CAAC,IAAtB,CAA2B,EAAE,CAAC,MAA9B,CAAqC,KAAK,CAAC,WAA3C,2FADF,EADF,EADF,CASD,CA1GD,CA4GA,cAAeR,CAAAA,KAAf","sourcesContent":["import React, { useEffect, useCallback, useState } from 'react'\nimport styled from 'styled-components'\nimport { Route, useRouteMatch } from 'react-router-dom'\nimport { useDispatch } from 'react-redux'\nimport BigNumber from 'bignumber.js'\nimport { useWallet } from '@binance-chain/bsc-use-wallet'\nimport { provider } from 'web3-core'\nimport { Image, Heading } from '@pancakeswap-libs/uikit'\nimport { BLOCKS_PER_YEAR, CAKE_PER_BLOCK, CAKE_POOL_PID } from 'config'\nimport FlexLayout from 'components/layout/Flex'\nimport Page from 'components/layout/Page'\nimport { useFarms, usePriceBnbBusd, usePriceCakeBusd } from 'state/hooks'\nimport useRefresh from 'hooks/useRefresh'\nimport { fetchFarmUserDataAsync } from 'state/actions'\nimport { QuoteToken } from 'config/constants/types'\nimport useI18n from 'hooks/useI18n'\nimport FarmCard, { FarmWithStakedValue } from './components/FarmCard/FarmCard'\nimport FarmTabButtons from './components/FarmTabButtons'\nimport Divider from './components/Divider'\n\nexport interface FarmsProps{\n  tokenMode?: boolean\n}\n\nconst Farms: React.FC<FarmsProps> = (farmsProps) => {\n  const { path } = useRouteMatch()\n  const TranslateString = useI18n()\n  const farmsLP = useFarms()\n  const cakePrice = usePriceCakeBusd()\n  const bnbPrice = usePriceBnbBusd()\n  const { account, ethereum }: { account: string; ethereum: provider } = useWallet()\n  const {tokenMode} = farmsProps;\n\n  const dispatch = useDispatch()\n  const { fastRefresh } = useRefresh()\n  useEffect(() => { \n    if (account) {\n      dispatch(fetchFarmUserDataAsync(account))\n    }\n  }, [account, dispatch, fastRefresh])\n\n  const [stakedOnly, setStakedOnly] = useState(false)\n\n  const activeFarms = farmsLP.filter((farm) => !!farm.isTokenOnly === !!tokenMode && farm.multiplier !== '0X' && farm.pid !== 8)\n  const inactiveFarms = farmsLP.filter((farm) => !!farm.isTokenOnly === !!tokenMode && farm.multiplier === '0X' && farm.pid !== 8)\n\n  const stakedOnlyFarms = activeFarms.filter(\n    (farm) => farm.userData && new BigNumber(farm.userData.stakedBalance).isGreaterThan(0),\n  )\n\n  const Hero = styled.div`\n  align-items: center;\n  background-image: url('/images/egg/3ba.svg');\n  background-repeat: no-repeat;\n  background-position: top center;\n  display: flex;\n  justify-content: center;\n  flex-direction: column;\n  margin: auto;\n  margin-bottom: 32px;\n  padding-top: 116px;\n  text-align: center;\n\n  ${({ theme }) => theme.mediaQueries.lg} {\n    background-image: url('/images/egg/9.png');\n    background-position: left center, right center;\n    height: 165px;\n    padding-top: 0;\n  }\n  `\n\n  // /!\\ This function will be removed soon\n  // This function compute the APY for each farm and will be replaced when we have a reliable API\n  // to retrieve assets prices against USD\n  const farmsList = useCallback(\n    (farmsToDisplay, removed: boolean) => {\n      // const cakePriceVsBNB = new BigNumber(farmsLP.find((farm) => farm.pid === CAKE_POOL_PID)?.tokenPriceVsQuote || 0)\n      // let userTotalTVL = new BigNumber(0);\n      // let userAllowance = 0;\n      const farmsToDisplayWithAPY: FarmWithStakedValue[] = farmsToDisplay.map((farm) => {\n        // if (!farm.tokenAmount || !farm.lpTotalInQuoteToken || !farm.lpTotalInQuoteToken) {\n        //   return farm\n        // }\n        const cakeRewardPerBlock = new BigNumber(farm.honestPerBlock || 1).times(new BigNumber(farm.poolWeight)) .div(new BigNumber(10).pow(18))\n        const cakeRewardPerYear = cakeRewardPerBlock.times(BLOCKS_PER_YEAR)\n        // if (farm.userData) {\n        //   const userShare = new BigNumber(farm.userData.stakedBalance).div(1000000000000000000).multipliedBy(farm.tokenPriceVsQuote)\n        //   userTotalTVL = userTotalTVL.plus(userShare)\n        //   const userWL = Whitelist.find(add => add.wallet === account);\n        //   userAllowance = userWL.allowance\n        // }\n\n        let apy = cakePrice.times(cakeRewardPerYear);\n\n        let totalValue = new BigNumber(farm.lpTotalInQuoteToken || 0);\n\n        if (farm.quoteTokenSymbol === QuoteToken.BNB) {\n          totalValue = totalValue.times(bnbPrice);\n        }\n\n        if(totalValue.comparedTo(0) > 0){\n          apy = apy.div(totalValue);\n        }\n\n        return { ...farm, apy }\n      })\n      return farmsToDisplayWithAPY.map((farm) => (\n        <FarmCard\n          key={farm.pid}\n          farm={farm}\n          removed={removed}\n          bnbPrice={bnbPrice}\n          cakePrice={cakePrice}\n          ethereum={ethereum}\n          account={account}\n        />\n      ))\n    },\n    [bnbPrice, account, cakePrice, ethereum],\n  )\n\n  return (\n    <Page>\n      <Hero>\n        <Heading as=\"h1\" size=\"xl\" mb=\"24px\" color=\"secondary\">\n          🚜 Cabbage Carrot and other veggie NFTs Coming Soon... 🚜\n        </Heading>\n      </Hero>\n    </Page>\n  )\n}\n\nexport default Farms\n"]},"metadata":{},"sourceType":"module"}